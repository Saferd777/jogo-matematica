<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<title>Jogo com Ranking Firebase</title>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
<style>
  body { font-family: Arial, sans-serif; }
  #ranking { margin-top: 20px; }
</style>
</head>
<body>

<h1>Jogo com Ranking</h1>

<div>
  <button id="startBtn">Iniciar Jogo</button>
  <button id="finishBtn" disabled>Finalizar Jogo</button>
  <p>Tempo: <span id="timer">0</span> segundos</p>
</div>

<div id="ranking">
  <h2>Ranking</h2>
  <ol id="rankingList"></ol>
</div>

<script>
// Cole aqui a configuração do seu Firebase, pegando do passo 3:
const firebaseConfig = {
  apiKey: "SEU_API_KEY",
  authDomain: "SEU_AUTH_DOMAIN",
  databaseURL: "SUA_DATABASE_URL",
  projectId: "SEU_PROJECT_ID",
  storageBucket: "SEU_STORAGE_BUCKET",
  messagingSenderId: "SEU_MESSAGING_SENDER_ID",
  appId: "SEU_APP_ID"
};

// Inicializa Firebase
firebase.initializeApp(firebaseConfig);
const db = firebase.database();

let timerInterval;
let tempo = 0;

const timerEl = document.getElementById('timer');
const startBtn = document.getElementById('startBtn');
const finishBtn = document.getElementById('finishBtn');

startBtn.onclick = () => {
  tempo = 0;
  timerEl.textContent = tempo;
  startBtn.disabled = true;
  finishBtn.disabled = false;
  timerInterval = setInterval(() => {
    tempo++;
    timerEl.textContent = tempo;
  }, 1000);
};

finishBtn.onclick = () => {
  clearInterval(timerInterval);
  finishBtn.disabled = true;
  startBtn.disabled = false;
  const nome = prompt("Qual é seu nome?");
  if(!nome) {
    alert("Você precisa digitar seu nome para salvar o tempo!");
    return;
  }
  salvarTempo(nome, tempo);
};

function salvarTempo(nome, tempo) {
  // salva no banco
  const rankingRef = db.ref('ranking');
  // cria um novo item com push()
  rankingRef.push({
    nome: nome,
    tempo: tempo
  }).then(() => {
    alert("Tempo salvo!");
    mostrarRanking();
  }).catch((error) => {
    alert("Erro ao salvar: " + error.message);
  });
}

function mostrarRanking() {
  const rankingRef = db.ref('ranking');
  rankingRef.orderByChild('tempo').limitToFirst(10).once('value', snapshot => {
    const rankingList = document.getElementById('rankingList');
    rankingList.innerHTML = '';
    if (!snapshot.exists()) {
      rankingList.innerHTML = '<li>Nenhum registro ainda.</li>';
      return;
    }
    snapshot.forEach(child => {
      const item = child.val();
      const li = document.createElement('li');
      li.textContent = `${item.nome} - ${item.tempo} segundos`;
      rankingList.appendChild(li);
    });
  });
}

// Mostra o ranking ao abrir a página
mostrarRanking();
</script>

</body>
</html>

